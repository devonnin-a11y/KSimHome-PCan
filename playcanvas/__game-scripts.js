console.log("hudBridge loaded");var HudBridge=pc.createScript("hudBridge");HudBridge.attributes.add("kelly",{type:"entity"}),HudBridge.attributes.add("bed",{type:"entity"}),HudBridge.attributes.add("sink",{type:"entity"}),HudBridge.attributes.add("stove",{type:"entity"}),HudBridge.prototype.initialize=function(){window.addEventListener("message",(t=>{const o=t.data||{};o.type&&("EMOTION"===o.type&&this.onEmotion(o.key),"XP"===o.type&&this.onXP(o.skill,o.amount),"ACTION"===o.type&&this.onAction(o.key),"TIMER_DONE"===o.type&&this.onTimerDone(o.key))})),this.setupClick(this.bed,"BED"),this.setupClick(this.sink,"SINK"),this.setupClick(this.stove,"STOVE"),this.postToHud({type:"WORLD_READY"})},HudBridge.prototype.postToHud=function(t){try{window.parent.postMessage(t,"*")}catch(t){}},HudBridge.prototype.setupClick=function(t,o){t?(t.collision||t.addComponent("collision",{type:"box"}),t.rigidbody||t.addComponent("rigidbody",{type:"static"}),t.on("picked",(()=>{this.postToHud({type:"INTERACT",action:o}),console.log("INTERACT",o)}))):console.warn("hudBridge missing entity for",o)},HudBridge.prototype.onEmotion=function(t){"sad"===t||"upset"===t||"scared"===t||"uncomfortable"===t?this.setMoodLighting(.7):"focused"===t||"fine"===t||"embarrassed"===t?this.setMoodLighting(.9):this.setMoodLighting(1)},HudBridge.prototype.onXP=function(t,o){console.log("XP:",t,o)},HudBridge.prototype.onAction=function(t){console.log("Action:",t)},HudBridge.prototype.onTimerDone=function(t){console.log("Timer done:",t)},HudBridge.prototype.setMoodLighting=function(t){const o=this.app.root.findByName("Light");o&&o.light&&(o.light.intensity=t)};var ClickPick=pc.createScript("clickPick");ClickPick.prototype.initialize=function(){this.camera=this.app.root.findByName("Camera"),this.camera||console.warn('No entity named "Camera" found.'),this.app.mouse&&this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onPointer,this),this.app.touch&&this.app.touch.on(pc.EVENT_TOUCHSTART,this.onPointer,this)},ClickPick.prototype.onPointer=function(i){const t=this.camera&&this.camera.camera?this.camera.camera:null;if(!t)return;let e,o;if(void 0!==i.x)e=i.x,o=i.y;else{if(!i.touches||!i.touches[0])return;e=i.touches[0].x,o=i.touches[0].y}const c=t.screenToWorld(e,o,t.nearClip),a=t.screenToWorld(e,o,t.farClip),r=this.app.systems.rigidbody.raycastFirst(c,a);r&&r.entity&&(r.entity.fire("picked"),console.log("Picked:",r.entity.name))};